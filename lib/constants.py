#
#

# Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013 Google Inc.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
# 02110-1301, USA.


"""Module holding different constants."""

import re
import socket

from ganeti import _constants
from ganeti import _vcsversion
from ganeti import compat
from ganeti import pathutils


# various versions
RELEASE_VERSION = _constants.RELEASE_VERSION
OS_API_V10 = _constants.OS_API_V10
OS_API_V15 = _constants.OS_API_V15
OS_API_V20 = _constants.OS_API_V20
OS_API_VERSIONS = _constants.OS_API_VERSIONS
VCS_VERSION = _vcsversion.VCS_VERSION
EXPORT_VERSION = _constants.EXPORT_VERSION
RAPI_VERSION = _constants.RAPI_VERSION

VERSION_MAJOR = _constants.VERSION_MAJOR
VERSION_MINOR = _constants.VERSION_MINOR
VERSION_REVISION = _constants.VERSION_REVISION

DIR_VERSION = _constants.DIR_VERSION

CONFIG_MAJOR = _constants.CONFIG_MAJOR
CONFIG_MINOR = _constants.CONFIG_MINOR
CONFIG_REVISION = _constants.CONFIG_REVISION
CONFIG_VERSION = _constants.CONFIG_VERSION

PROTOCOL_VERSION = _constants.PROTOCOL_VERSION

DAEMONS_GROUP = _constants.DAEMONS_GROUP
ADMIN_GROUP = _constants.ADMIN_GROUP
MASTERD_USER = _constants.MASTERD_USER
MASTERD_GROUP = _constants.MASTERD_GROUP
RAPI_USER = _constants.RAPI_USER
RAPI_GROUP = _constants.RAPI_GROUP
CONFD_USER = _constants.CONFD_USER
CONFD_GROUP = _constants.CONFD_GROUP
LUXID_USER = _constants.LUXID_USER
LUXID_GROUP = _constants.LUXID_GROUP
NODED_USER = _constants.NODED_USER
NODED_GROUP = _constants.NODED_GROUP
MOND_USER = _constants.MOND_USER
MOND_GROUP = _constants.MOND_GROUP
SSH_LOGIN_USER = _constants.SSH_LOGIN_USER
SSH_CONSOLE_USER = _constants.SSH_CONSOLE_USER

CPU_PINNING_SEP = _constants.CPU_PINNING_SEP
CPU_PINNING_ALL = _constants.CPU_PINNING_ALL
CPU_PINNING_ALL_VAL = _constants.CPU_PINNING_ALL_VAL
CPU_PINNING_OFF = _constants.CPU_PINNING_OFF

CPU_PINNING_ALL_XEN = _constants.CPU_PINNING_ALL_XEN

CPU_PINNING_ALL_KVM = _constants.CPU_PINNING_ALL_KVM

DD_CMD = _constants.DD_CMD
MAX_WIPE_CHUNK = _constants.MAX_WIPE_CHUNK
MIN_WIPE_CHUNK_PERCENT = _constants.MIN_WIPE_CHUNK_PERCENT

RUN_DIRS_MODE = _constants.RUN_DIRS_MODE
SECURE_DIR_MODE = _constants.SECURE_DIR_MODE
SECURE_FILE_MODE = _constants.SECURE_FILE_MODE
ADOPTABLE_BLOCKDEV_ROOT = _constants.ADOPTABLE_BLOCKDEV_ROOT
ENABLE_CONFD = _constants.ENABLE_CONFD
ENABLE_MOND = _constants.ENABLE_MOND
ENABLE_SPLIT_QUERY = _constants.ENABLE_SPLIT_QUERY
ENABLE_RESTRICTED_COMMANDS = _constants.ENABLE_RESTRICTED_COMMANDS

SSH = _constants.SSH
SCP = _constants.SCP

NODED = _constants.NODED
CONFD = _constants.CONFD
LUXID = _constants.LUXID
RAPI = _constants.RAPI
MASTERD = _constants.MASTERD
MOND = _constants.MOND

DAEMONS = _constants.DAEMONS

DAEMONS_PORTS = _constants.DAEMONS_PORTS

DEFAULT_NODED_PORT = _constants.DEFAULT_NODED_PORT
DEFAULT_CONFD_PORT = _constants.DEFAULT_CONFD_PORT
DEFAULT_MOND_PORT = _constants.DEFAULT_MOND_PORT
DEFAULT_RAPI_PORT = _constants.DEFAULT_RAPI_PORT

FIRST_DRBD_PORT = _constants.FIRST_DRBD_PORT
LAST_DRBD_PORT = _constants.LAST_DRBD_PORT

DAEMONS_LOGBASE = _constants.DAEMONS_LOGBASE

DAEMONS_LOGFILES = \
    dict((daemon, pathutils.GetLogFilename(DAEMONS_LOGBASE[daemon]))
         for daemon in DAEMONS_LOGBASE)

# Some daemons might require more than one logfile.
# Specifically, right now only the Haskell http library "snap", used by the
# monitoring daemon, requires multiple log files.

# These are the only valid reasons for having an extra logfile
EXTRA_LOGREASON_ACCESS = "access"
EXTRA_LOGREASON_ERROR = "error"

VALID_EXTRA_LOGREASONS = compat.UniqueFrozenset([
  EXTRA_LOGREASON_ACCESS,
  EXTRA_LOGREASON_ERROR,
  ])

# These are the extra logfiles, grouped by daemon
DAEMONS_EXTRA_LOGBASE = {
  MOND: {
    EXTRA_LOGREASON_ACCESS: _constants.EXTRA_LOGREASON_ACCESS,
    EXTRA_LOGREASON_ERROR: _constants.EXTRA_LOGREASON_ERROR,
    }
  }

DAEMONS_EXTRA_LOGFILES = \
  dict((daemon, dict((extra,
       pathutils.GetLogFilename(DAEMONS_EXTRA_LOGBASE[daemon][extra]))
       for extra in DAEMONS_EXTRA_LOGBASE[daemon]))
         for daemon in DAEMONS_EXTRA_LOGBASE)

DEV_CONSOLE = _constants.DEV_CONSOLE

PROC_MOUNTS = _constants.PROC_MOUNTS

LUXI_EOM = _constants.LUXI_EOM
LUXI_VERSION = _constants.LUXI_VERSION
LUXI_OVERRIDE = _constants.LUXI_OVERRIDE
LUXI_OVERRIDE_MASTER = _constants.LUXI_OVERRIDE_MASTER
LUXI_OVERRIDE_QUERY = _constants.LUXI_OVERRIDE_QUERY

SYSLOG_USAGE = _constants.SYSLOG_USAGE
SYSLOG_NO = _constants.SYSLOG_NO
SYSLOG_YES = _constants.SYSLOG_YES
SYSLOG_ONLY = _constants.SYSLOG_ONLY
SYSLOG_SOCKET = _constants.SYSLOG_SOCKET

EXPORT_CONF_FILE = _constants.EXPORT_CONF_FILE

XEN_BOOTLOADER = _constants.XEN_BOOTLOADER
XEN_KERNEL = _constants.XEN_KERNEL
XEN_INITRD = _constants.XEN_INITRD
XEN_CMD_XM = _constants.XEN_CMD_XM
XEN_CMD_XL = _constants.XEN_CMD_XL
KNOWN_XEN_COMMANDS = _constants.KNOWN_XEN_COMMANDS

# When the Xen toolstack used is "xl", live migration requires the source host
# to connect to the target host via ssh (xl runs this command). We need to pass
# the command xl runs some extra info so that it can use Ganeti's key
# verification and not fail. Note that this string is incomplete: it must be
# filled with the cluster name before being used.
XL_SSH_CMD = ("ssh -l %s -oGlobalKnownHostsFile=%s"
              " -oUserKnownHostsFile=/dev/null"
              " -oCheckHostIp=no -oStrictHostKeyChecking=yes"
              " -oHostKeyAlias=%%s") % (SSH_LOGIN_USER,
                                        pathutils.SSH_KNOWN_HOSTS_FILE)

KVM_PATH = _constants.KVM_PATH
KVM_KERNEL = _constants.KVM_KERNEL
SOCAT_PATH = _constants.SOCAT_PATH
SOCAT_USE_ESCAPE = _constants.SOCAT_USE_ESCAPE
SOCAT_USE_COMPRESS = _constants.SOCAT_USE_COMPRESS
SOCAT_ESCAPE_CODE = _constants.SOCAT_ESCAPE_CODE


CONS_SSH = _constants.CONS_SSH
CONS_VNC = _constants.CONS_VNC
CONS_SPICE = _constants.CONS_SPICE
CONS_MESSAGE = _constants.CONS_MESSAGE
CONS_ALL = _constants.CONS_ALL

RSA_KEY_BITS = _constants.RSA_KEY_BITS
OPENSSL_CIPHERS = _constants.OPENSSL_CIPHERS

X509_CERT_SIGN_DIGEST = _constants.X509_CERT_SIGN_DIGEST
X509_CERT_DEFAULT_VALIDITY = _constants.X509_CERT_DEFAULT_VALIDITY
X509_CERT_CN = _constants.X509_CERT_CN
X509_CERT_SIGNATURE_HEADER = _constants.X509_CERT_SIGNATURE_HEADER

# Import/export daemon mode
IEM_IMPORT = _constants.IEM_IMPORT
IEM_EXPORT = _constants.IEM_EXPORT

# Import/export transport compression
IEC_NONE = _constants.IEC_NONE
IEC_GZIP = _constants.IEC_GZIP
IEC_ALL = _constants.IEC_ALL

IE_CUSTOM_SIZE = _constants.IE_CUSTOM_SIZE

IE_MAGIC_RE = re.compile(r"^[-_.a-zA-Z0-9]{5,100}$")

IEIO_FILE = _constants.IEIO_FILE
IEIO_RAW_DISK = _constants.IEIO_RAW_DISK
IEIO_SCRIPT = _constants.IEIO_SCRIPT

VALUE_DEFAULT = "default"
VALUE_AUTO = "auto"
VALUE_GENERATE = "generate"
VALUE_NONE = "none"
VALUE_TRUE = "true"
VALUE_FALSE = "false"
VALUE_HS_NOTHING = {"Nothing": None}


# External script validation mask
EXT_PLUGIN_MASK = re.compile("^[a-zA-Z0-9_-]+$")

HOOKS_PHASE_PRE = _constants.HOOKS_PHASE_PRE
HOOKS_PHASE_POST = _constants.HOOKS_PHASE_POST
HOOKS_NAME_CFGUPDATE = _constants.HOOKS_NAME_CFGUPDATE
HOOKS_NAME_WATCHER = _constants.HOOKS_NAME_WATCHER
HOOKS_VERSION = _constants.HOOKS_VERSION
HOOKS_PATH = _constants.HOOKS_PATH

HTYPE_CLUSTER = _constants.HTYPE_CLUSTER
HTYPE_NODE = _constants.HTYPE_NODE
HTYPE_GROUP = _constants.HTYPE_GROUP
HTYPE_INSTANCE = _constants.HTYPE_INSTANCE
HTYPE_NETWORK = _constants.HTYPE_NETWORK

HKR_SKIP = _constants.HKR_SKIP
HKR_FAIL = _constants.HKR_FAIL
HKR_SUCCESS = _constants.HKR_SUCCESS

ST_BLOCK = _constants.ST_BLOCK
ST_DISKLESS = _constants.ST_DISKLESS
ST_EXT = _constants.ST_EXT
ST_FILE = _constants.ST_FILE
ST_LVM_PV = _constants.ST_LVM_PV
ST_LVM_VG = _constants.ST_LVM_VG
ST_RADOS = _constants.ST_RADOS
STORAGE_TYPES = _constants.STORAGE_TYPES
STS_REPORT = _constants.STS_REPORT

# Storage fields
# first two are valid in LU context only, not passed to backend
SF_NODE = _constants.SF_NODE
SF_TYPE = _constants.SF_TYPE
# and the rest are valid in backend
SF_NAME = _constants.SF_NAME
SF_SIZE = _constants.SF_SIZE
SF_FREE = _constants.SF_FREE
SF_USED = _constants.SF_USED
SF_ALLOCATABLE = _constants.SF_ALLOCATABLE
VALID_STORAGE_FIELDS = _constants.VALID_STORAGE_FIELDS
MODIFIABLE_STORAGE_FIELDS = _constants.MODIFIABLE_STORAGE_FIELDS

SO_FIX_CONSISTENCY = _constants.SO_FIX_CONSISTENCY
VALID_STORAGE_OPERATIONS = _constants.VALID_STORAGE_OPERATIONS

VF_DEV = _constants.VF_DEV
VF_INSTANCE = _constants.VF_INSTANCE
VF_NAME = _constants.VF_NAME
VF_NODE = _constants.VF_NODE
VF_PHYS = _constants.VF_PHYS
VF_SIZE = _constants.VF_SIZE
VF_VG = _constants.VF_VG

LDS_OKAY = _constants.LDS_OKAY
LDS_UNKNOWN = _constants.LDS_UNKNOWN
LDS_FAULTY = _constants.LDS_FAULTY
LDS_NAMES = _constants.LDS_NAMES

DT_BLOCK = _constants.DT_BLOCK
DT_DISKLESS = _constants.DT_DISKLESS
DT_DRBD8 = _constants.DT_DRBD8
DT_EXT = _constants.DT_EXT
DT_FILE = _constants.DT_FILE
DT_PLAIN = _constants.DT_PLAIN
DT_RBD = _constants.DT_RBD
DT_SHARED_FILE = _constants.DT_SHARED_FILE
DISK_TEMPLATE_PREFERENCE = _constants.DISK_TEMPLATE_PREFERENCE
DISK_TEMPLATES = _constants.DISK_TEMPLATES
DEFAULT_ENABLED_DISK_TEMPLATES = _constants.DEFAULT_ENABLED_DISK_TEMPLATES

MAP_DISK_TEMPLATE_STORAGE_TYPE = _constants.MAP_DISK_TEMPLATE_STORAGE_TYPE

DTS_INT_MIRROR = _constants.DTS_INT_MIRROR
DTS_EXT_MIRROR = _constants.DTS_EXT_MIRROR
DTS_NOT_LVM = _constants.DTS_NOT_LVM
DTS_GROWABLE = _constants.DTS_GROWABLE
DTS_MAY_ADOPT = _constants.DTS_MAY_ADOPT
DTS_MUST_ADOPT = _constants.DTS_MUST_ADOPT
DTS_MIRRORED = _constants.DTS_MIRRORED
DTS_FILEBASED = _constants.DTS_FILEBASED
DTS_COPYABLE = _constants.DTS_COPYABLE
DTS_EXCL_STORAGE = _constants.DTS_EXCL_STORAGE
DTS_NO_FREE_SPACE_CHECK = _constants.DTS_NO_FREE_SPACE_CHECK
DTS_BLOCK = _constants.DTS_BLOCK

DRBD_HMAC_ALG = _constants.DRBD_HMAC_ALG
DRBD_DEFAULT_NET_PROTOCOL = _constants.DRBD_DEFAULT_NET_PROTOCOL
DRBD_MIGRATION_NET_PROTOCOL = _constants.DRBD_MIGRATION_NET_PROTOCOL
DRBD_STATUS_FILE = _constants.DRBD_STATUS_FILE
DRBD_META_SIZE = _constants.DRBD_META_SIZE

DRBD_B_NONE = _constants.DRBD_B_NONE
DRBD_B_DISK_BARRIERS = _constants.DRBD_B_DISK_BARRIERS
DRBD_B_DISK_DRAIN = _constants.DRBD_B_DISK_DRAIN
DRBD_B_DISK_FLUSH = _constants.DRBD_B_DISK_FLUSH

# Valid barrier combinations: "n" or any non-null subset of "bfd"
DRBD_VALID_BARRIER_OPT = compat.UniqueFrozenset([
  frozenset([DRBD_B_NONE]),
  frozenset([DRBD_B_DISK_BARRIERS]),
  frozenset([DRBD_B_DISK_DRAIN]),
  frozenset([DRBD_B_DISK_FLUSH]),
  frozenset([DRBD_B_DISK_DRAIN, DRBD_B_DISK_FLUSH]),
  frozenset([DRBD_B_DISK_BARRIERS, DRBD_B_DISK_DRAIN]),
  frozenset([DRBD_B_DISK_BARRIERS, DRBD_B_DISK_FLUSH]),
  frozenset([DRBD_B_DISK_BARRIERS, DRBD_B_DISK_FLUSH, DRBD_B_DISK_DRAIN]),
  ])

RBD_CMD = _constants.RBD_CMD

FD_BLKTAP = _constants.FD_BLKTAP
FD_LOOP = _constants.FD_LOOP
FILE_DRIVER = _constants.FILE_DRIVER

LDS_DRBD = _constants.LDS_DRBD

DISK_RDONLY = _constants.DISK_RDONLY
DISK_RDWR = _constants.DISK_RDWR
DISK_ACCESS_SET = _constants.DISK_ACCESS_SET
DISK_USERSPACE = _constants.DISK_USERSPACE
DISK_KERNELSPACE = _constants.DISK_KERNELSPACE
DISK_VALID_ACCESS_MODES = _constants.DISK_VALID_ACCESS_MODES

REPLACE_DISK_PRI = _constants.REPLACE_DISK_PRI
REPLACE_DISK_SEC = _constants.REPLACE_DISK_SEC
REPLACE_DISK_CHG = _constants.REPLACE_DISK_CHG
REPLACE_DISK_AUTO = _constants.REPLACE_DISK_AUTO
REPLACE_MODES = _constants.REPLACE_MODES

EXPORT_MODE_LOCAL = _constants.EXPORT_MODE_LOCAL
EXPORT_MODE_REMOTE = _constants.EXPORT_MODE_REMOTE
EXPORT_MODES = _constants.EXPORT_MODES

INSTANCE_CREATE = _constants.INSTANCE_CREATE
INSTANCE_IMPORT = _constants.INSTANCE_IMPORT
INSTANCE_REMOTE_IMPORT = _constants.INSTANCE_REMOTE_IMPORT
INSTANCE_CREATE_MODES = _constants.INSTANCE_CREATE_MODES

RIE_VERSION = _constants.RIE_VERSION
RIE_HANDSHAKE = _constants.RIE_HANDSHAKE
RIE_CERT_VALIDITY = _constants.RIE_CERT_VALIDITY
RIE_CONNECT_TIMEOUT = _constants.RIE_CONNECT_TIMEOUT
RIE_CONNECT_ATTEMPT_TIMEOUT = _constants.RIE_CONNECT_ATTEMPT_TIMEOUT
RIE_CONNECT_RETRIES = _constants.RIE_CONNECT_RETRIES
CHILD_LINGER_TIMEOUT = _constants.CHILD_LINGER_TIMEOUT

INISECT_EXP = _constants.INISECT_EXP
INISECT_INS = _constants.INISECT_INS
INISECT_HYP = _constants.INISECT_HYP
INISECT_BEP = _constants.INISECT_BEP
INISECT_OSP = _constants.INISECT_OSP

DDM_ADD = _constants.DDM_ADD
DDM_MODIFY = _constants.DDM_MODIFY
DDM_REMOVE = _constants.DDM_REMOVE
DDMS_VALUES = _constants.DDMS_VALUES
DDMS_VALUES_WITH_MODIFY = _constants.DDMS_VALUES_WITH_MODIFY

EXIT_SUCCESS = _constants.EXIT_SUCCESS
EXIT_FAILURE = _constants.EXIT_FAILURE
EXIT_NOTCLUSTER = _constants.EXIT_NOTCLUSTER
EXIT_NOTMASTER = _constants.EXIT_NOTMASTER
EXIT_NODESETUP_ERROR = _constants.EXIT_NODESETUP_ERROR
EXIT_CONFIRMATION = _constants.EXIT_CONFIRMATION
EXIT_UNKNOWN_FIELD = _constants.EXIT_UNKNOWN_FIELD

TAG_CLUSTER = _constants.TAG_CLUSTER
TAG_NODEGROUP = _constants.TAG_NODEGROUP
TAG_NODE = _constants.TAG_NODE
TAG_INSTANCE = _constants.TAG_INSTANCE
TAG_NETWORK = _constants.TAG_NETWORK
VALID_TAG_TYPES = _constants.VALID_TAG_TYPES

MAX_TAG_LEN = _constants.MAX_TAG_LEN
MAX_TAGS_PER_OBJ = _constants.MAX_TAGS_PER_OBJ

# others
DEFAULT_BRIDGE = _constants.DEFAULT_BRIDGE
DEFAULT_OVS = _constants.DEFAULT_OVS
CLASSIC_DRBD_SYNC_SPEED = _constants.CLASSIC_DRBD_SYNC_SPEED
IP4_ADDRESS_LOCALHOST = _constants.IP4_ADDRESS_LOCALHOST
IP4_ADDRESS_ANY = _constants.IP4_ADDRESS_ANY
IP6_ADDRESS_LOCALHOST = _constants.IP6_ADDRESS_LOCALHOST
IP6_ADDRESS_ANY = _constants.IP6_ADDRESS_ANY
IP4_VERSION = _constants.IP4_VERSION
IP6_VERSION = _constants.IP6_VERSION
VALID_IP_VERSIONS = _constants.VALID_IP_VERSIONS
# for export to htools
IP4_FAMILY = socket.AF_INET
IP6_FAMILY = socket.AF_INET6

TCP_PING_TIMEOUT = _constants.TCP_PING_TIMEOUT
DEFAULT_VG = _constants.DEFAULT_VG
DEFAULT_DRBD_HELPER = _constants.DEFAULT_DRBD_HELPER
MIN_VG_SIZE = _constants.MIN_VG_SIZE
DEFAULT_MAC_PREFIX = _constants.DEFAULT_MAC_PREFIX
DEFAULT_SHUTDOWN_TIMEOUT = _constants.DEFAULT_SHUTDOWN_TIMEOUT
NODE_MAX_CLOCK_SKEW = _constants.NODE_MAX_CLOCK_SKEW
DISK_TRANSFER_CONNECT_TIMEOUT = _constants.DISK_TRANSFER_CONNECT_TIMEOUT
DISK_SEPARATOR = _constants.DISK_SEPARATOR
IP_COMMAND_PATH = _constants.IP_COMMAND_PATH
JOB_IDS_KEY = _constants.JOB_IDS_KEY

RUNPARTS_SKIP = _constants.RUNPARTS_SKIP
RUNPARTS_RUN = _constants.RUNPARTS_RUN
RUNPARTS_ERR = _constants.RUNPARTS_ERR
RUNPARTS_STATUS = _constants.RUNPARTS_STATUS

RPC_ENCODING_NONE = _constants.RPC_ENCODING_NONE
RPC_ENCODING_ZLIB_BASE64 = _constants.RPC_ENCODING_ZLIB_BASE64

RPC_TMO_URGENT = _constants.RPC_TMO_URGENT
RPC_TMO_FAST = _constants.RPC_TMO_FAST
RPC_TMO_NORMAL = _constants.RPC_TMO_NORMAL
RPC_TMO_SLOW = _constants.RPC_TMO_SLOW
RPC_TMO_4HRS = _constants.RPC_TMO_4HRS
RPC_TMO_1DAY = _constants.RPC_TMO_1DAY
RPC_CONNECT_TIMEOUT = _constants.RPC_CONNECT_TIMEOUT

OS_SCRIPT_CREATE = _constants.OS_SCRIPT_CREATE
OS_SCRIPT_IMPORT = _constants.OS_SCRIPT_IMPORT
OS_SCRIPT_EXPORT = _constants.OS_SCRIPT_EXPORT
OS_SCRIPT_RENAME = _constants.OS_SCRIPT_RENAME
OS_SCRIPT_VERIFY = _constants.OS_SCRIPT_VERIFY
OS_SCRIPTS = _constants.OS_SCRIPTS

OS_API_FILE = _constants.OS_API_FILE
OS_VARIANTS_FILE = _constants.OS_VARIANTS_FILE
OS_PARAMETERS_FILE = _constants.OS_PARAMETERS_FILE

OS_VALIDATE_PARAMETERS = _constants.OS_VALIDATE_PARAMETERS
OS_VALIDATE_CALLS = _constants.OS_VALIDATE_CALLS

ES_ACTION_CREATE = _constants.ES_ACTION_CREATE
ES_ACTION_REMOVE = _constants.ES_ACTION_REMOVE
ES_ACTION_GROW = _constants.ES_ACTION_GROW
ES_ACTION_ATTACH = _constants.ES_ACTION_ATTACH
ES_ACTION_DETACH = _constants.ES_ACTION_DETACH
ES_ACTION_SETINFO = _constants.ES_ACTION_SETINFO
ES_ACTION_VERIFY = _constants.ES_ACTION_VERIFY

ES_SCRIPT_CREATE = _constants.ES_SCRIPT_CREATE
ES_SCRIPT_REMOVE = _constants.ES_SCRIPT_REMOVE
ES_SCRIPT_GROW = _constants.ES_SCRIPT_GROW
ES_SCRIPT_ATTACH = _constants.ES_SCRIPT_ATTACH
ES_SCRIPT_DETACH = _constants.ES_SCRIPT_DETACH
ES_SCRIPT_SETINFO = _constants.ES_SCRIPT_SETINFO
ES_SCRIPT_VERIFY = _constants.ES_SCRIPT_VERIFY
ES_SCRIPTS = _constants.ES_SCRIPTS

ES_PARAMETERS_FILE = _constants.ES_PARAMETERS_FILE

INSTANCE_REBOOT_SOFT = _constants.INSTANCE_REBOOT_SOFT
INSTANCE_REBOOT_HARD = _constants.INSTANCE_REBOOT_HARD
INSTANCE_REBOOT_FULL = _constants.INSTANCE_REBOOT_FULL
REBOOT_TYPES = _constants.REBOOT_TYPES

INSTANCE_REBOOT_ALLOWED = _constants.INSTANCE_REBOOT_ALLOWED
INSTANCE_REBOOT_EXIT = _constants.INSTANCE_REBOOT_EXIT
REBOOT_BEHAVIORS = _constants.REBOOT_BEHAVIORS

VTYPE_STRING = _constants.VTYPE_STRING
VTYPE_MAYBE_STRING = _constants.VTYPE_MAYBE_STRING
VTYPE_BOOL = _constants.VTYPE_BOOL
VTYPE_SIZE = _constants.VTYPE_SIZE
VTYPE_INT = _constants.VTYPE_INT
ENFORCEABLE_TYPES = _constants.ENFORCEABLE_TYPES

IFACE_NO_IP_VERSION_SPECIFIED = _constants.IFACE_NO_IP_VERSION_SPECIFIED

VALID_SERIAL_SPEEDS = _constants.VALID_SERIAL_SPEEDS

HV_BOOT_ORDER = _constants.HV_BOOT_ORDER
HV_CDROM_IMAGE_PATH = _constants.HV_CDROM_IMAGE_PATH
HV_KVM_CDROM2_IMAGE_PATH = _constants.HV_KVM_CDROM2_IMAGE_PATH
HV_KVM_FLOPPY_IMAGE_PATH = _constants.HV_KVM_FLOPPY_IMAGE_PATH
HV_NIC_TYPE = _constants.HV_NIC_TYPE
HV_DISK_TYPE = _constants.HV_DISK_TYPE
HV_KVM_CDROM_DISK_TYPE = _constants.HV_KVM_CDROM_DISK_TYPE
HV_VNC_BIND_ADDRESS = _constants.HV_VNC_BIND_ADDRESS
HV_VNC_PASSWORD_FILE = _constants.HV_VNC_PASSWORD_FILE
HV_VNC_TLS = _constants.HV_VNC_TLS
HV_VNC_X509 = _constants.HV_VNC_X509
HV_VNC_X509_VERIFY = _constants.HV_VNC_X509_VERIFY
HV_KVM_SPICE_BIND = _constants.HV_KVM_SPICE_BIND
HV_KVM_SPICE_IP_VERSION = _constants.HV_KVM_SPICE_IP_VERSION
HV_KVM_SPICE_PASSWORD_FILE = _constants.HV_KVM_SPICE_PASSWORD_FILE
HV_KVM_SPICE_LOSSLESS_IMG_COMPR = _constants.HV_KVM_SPICE_LOSSLESS_IMG_COMPR
HV_KVM_SPICE_JPEG_IMG_COMPR = _constants.HV_KVM_SPICE_JPEG_IMG_COMPR
HV_KVM_SPICE_ZLIB_GLZ_IMG_COMPR = _constants.HV_KVM_SPICE_ZLIB_GLZ_IMG_COMPR
HV_KVM_SPICE_STREAMING_VIDEO_DETECTION = \
  _constants.HV_KVM_SPICE_STREAMING_VIDEO_DETECTION
HV_KVM_SPICE_AUDIO_COMPR = _constants.HV_KVM_SPICE_AUDIO_COMPR
HV_KVM_SPICE_USE_TLS = _constants.HV_KVM_SPICE_USE_TLS
HV_KVM_SPICE_TLS_CIPHERS = _constants.HV_KVM_SPICE_TLS_CIPHERS
HV_KVM_SPICE_USE_VDAGENT = _constants.HV_KVM_SPICE_USE_VDAGENT
HV_ACPI = _constants.HV_ACPI
HV_PAE = _constants.HV_PAE
HV_USE_BOOTLOADER = _constants.HV_USE_BOOTLOADER
HV_BOOTLOADER_ARGS = _constants.HV_BOOTLOADER_ARGS
HV_BOOTLOADER_PATH = _constants.HV_BOOTLOADER_PATH
HV_KERNEL_ARGS = _constants.HV_KERNEL_ARGS
HV_KERNEL_PATH = _constants.HV_KERNEL_PATH
HV_INITRD_PATH = _constants.HV_INITRD_PATH
HV_ROOT_PATH = _constants.HV_ROOT_PATH
HV_SERIAL_CONSOLE = _constants.HV_SERIAL_CONSOLE
HV_SERIAL_SPEED = _constants.HV_SERIAL_SPEED
HV_USB_MOUSE = _constants.HV_USB_MOUSE
HV_KEYMAP = _constants.HV_KEYMAP
HV_DEVICE_MODEL = _constants.HV_DEVICE_MODEL
HV_INIT_SCRIPT = _constants.HV_INIT_SCRIPT
HV_MIGRATION_PORT = _constants.HV_MIGRATION_PORT
HV_MIGRATION_BANDWIDTH = _constants.HV_MIGRATION_BANDWIDTH
HV_MIGRATION_DOWNTIME = _constants.HV_MIGRATION_DOWNTIME
HV_MIGRATION_MODE = _constants.HV_MIGRATION_MODE
HV_USE_LOCALTIME = _constants.HV_USE_LOCALTIME
HV_DISK_CACHE = _constants.HV_DISK_CACHE
HV_SECURITY_MODEL = _constants.HV_SECURITY_MODEL
HV_SECURITY_DOMAIN = _constants.HV_SECURITY_DOMAIN
HV_KVM_FLAG = _constants.HV_KVM_FLAG
HV_VHOST_NET = _constants.HV_VHOST_NET
HV_KVM_USE_CHROOT = _constants.HV_KVM_USE_CHROOT
HV_CPU_MASK = _constants.HV_CPU_MASK
HV_MEM_PATH = _constants.HV_MEM_PATH
HV_PASSTHROUGH = _constants.HV_PASSTHROUGH
HV_BLOCKDEV_PREFIX = _constants.HV_BLOCKDEV_PREFIX
HV_REBOOT_BEHAVIOR = _constants.HV_REBOOT_BEHAVIOR
HV_CPU_TYPE = _constants.HV_CPU_TYPE
HV_CPU_CAP = _constants.HV_CPU_CAP
HV_CPU_WEIGHT = _constants.HV_CPU_WEIGHT
HV_CPU_CORES = _constants.HV_CPU_CORES
HV_CPU_THREADS = _constants.HV_CPU_THREADS
HV_CPU_SOCKETS = _constants.HV_CPU_SOCKETS
HV_SOUNDHW = _constants.HV_SOUNDHW
HV_USB_DEVICES = _constants.HV_USB_DEVICES
HV_VGA = _constants.HV_VGA
HV_KVM_EXTRA = _constants.HV_KVM_EXTRA
HV_KVM_MACHINE_VERSION = _constants.HV_KVM_MACHINE_VERSION
HV_KVM_PATH = _constants.HV_KVM_PATH
HV_VIF_TYPE = _constants.HV_VIF_TYPE
HV_VIF_SCRIPT = _constants.HV_VIF_SCRIPT
HV_XEN_CMD = _constants.HV_XEN_CMD
HV_XEN_CPUID = _constants.HV_XEN_CPUID
HV_VNET_HDR = _constants.HV_VNET_HDR
HV_VIRIDIAN = _constants.HV_VIRIDIAN

HVS_PARAMETER_TYPES = {
  HV_KVM_PATH: VTYPE_STRING,
  HV_BOOT_ORDER: VTYPE_STRING,
  HV_KVM_FLOPPY_IMAGE_PATH: VTYPE_STRING,
  HV_CDROM_IMAGE_PATH: VTYPE_STRING,
  HV_KVM_CDROM2_IMAGE_PATH: VTYPE_STRING,
  HV_NIC_TYPE: VTYPE_STRING,
  HV_DISK_TYPE: VTYPE_STRING,
  HV_KVM_CDROM_DISK_TYPE: VTYPE_STRING,
  HV_VNC_PASSWORD_FILE: VTYPE_STRING,
  HV_VNC_BIND_ADDRESS: VTYPE_STRING,
  HV_VNC_TLS: VTYPE_BOOL,
  HV_VNC_X509: VTYPE_STRING,
  HV_VNC_X509_VERIFY: VTYPE_BOOL,
  HV_KVM_SPICE_BIND: VTYPE_STRING,
  HV_KVM_SPICE_IP_VERSION: VTYPE_INT,
  HV_KVM_SPICE_PASSWORD_FILE: VTYPE_STRING,
  HV_KVM_SPICE_LOSSLESS_IMG_COMPR: VTYPE_STRING,
  HV_KVM_SPICE_JPEG_IMG_COMPR: VTYPE_STRING,
  HV_KVM_SPICE_ZLIB_GLZ_IMG_COMPR: VTYPE_STRING,
  HV_KVM_SPICE_STREAMING_VIDEO_DETECTION: VTYPE_STRING,
  HV_KVM_SPICE_AUDIO_COMPR: VTYPE_BOOL,
  HV_KVM_SPICE_USE_TLS: VTYPE_BOOL,
  HV_KVM_SPICE_TLS_CIPHERS: VTYPE_STRING,
  HV_KVM_SPICE_USE_VDAGENT: VTYPE_BOOL,
  HV_ACPI: VTYPE_BOOL,
  HV_PAE: VTYPE_BOOL,
  HV_USE_BOOTLOADER: VTYPE_BOOL,
  HV_BOOTLOADER_PATH: VTYPE_STRING,
  HV_BOOTLOADER_ARGS: VTYPE_STRING,
  HV_KERNEL_PATH: VTYPE_STRING,
  HV_KERNEL_ARGS: VTYPE_STRING,
  HV_INITRD_PATH: VTYPE_STRING,
  HV_ROOT_PATH: VTYPE_MAYBE_STRING,
  HV_SERIAL_CONSOLE: VTYPE_BOOL,
  HV_SERIAL_SPEED: VTYPE_INT,
  HV_USB_MOUSE: VTYPE_STRING,
  HV_KEYMAP: VTYPE_STRING,
  HV_DEVICE_MODEL: VTYPE_STRING,
  HV_INIT_SCRIPT: VTYPE_STRING,
  HV_MIGRATION_PORT: VTYPE_INT,
  HV_MIGRATION_BANDWIDTH: VTYPE_INT,
  HV_MIGRATION_DOWNTIME: VTYPE_INT,
  HV_MIGRATION_MODE: VTYPE_STRING,
  HV_USE_LOCALTIME: VTYPE_BOOL,
  HV_DISK_CACHE: VTYPE_STRING,
  HV_SECURITY_MODEL: VTYPE_STRING,
  HV_SECURITY_DOMAIN: VTYPE_STRING,
  HV_KVM_FLAG: VTYPE_STRING,
  HV_VHOST_NET: VTYPE_BOOL,
  HV_KVM_USE_CHROOT: VTYPE_BOOL,
  HV_CPU_MASK: VTYPE_STRING,
  HV_MEM_PATH: VTYPE_STRING,
  HV_PASSTHROUGH: VTYPE_STRING,
  HV_BLOCKDEV_PREFIX: VTYPE_STRING,
  HV_REBOOT_BEHAVIOR: VTYPE_STRING,
  HV_CPU_TYPE: VTYPE_STRING,
  HV_CPU_CAP: VTYPE_INT,
  HV_CPU_WEIGHT: VTYPE_INT,
  HV_CPU_CORES: VTYPE_INT,
  HV_CPU_THREADS: VTYPE_INT,
  HV_CPU_SOCKETS: VTYPE_INT,
  HV_SOUNDHW: VTYPE_STRING,
  HV_USB_DEVICES: VTYPE_STRING,
  HV_VGA: VTYPE_STRING,
  HV_KVM_EXTRA: VTYPE_STRING,
  HV_KVM_MACHINE_VERSION: VTYPE_STRING,
  HV_VIF_TYPE: VTYPE_STRING,
  HV_VIF_SCRIPT: VTYPE_STRING,
  HV_XEN_CMD: VTYPE_STRING,
  HV_XEN_CPUID: VTYPE_STRING,
  HV_VNET_HDR: VTYPE_BOOL,
  HV_VIRIDIAN: VTYPE_BOOL,
  }

HVS_PARAMETERS = frozenset(HVS_PARAMETER_TYPES.keys())

HVS_PARAMETER_TITLES = _constants.HVS_PARAMETER_TITLES

HV_MIGRATION_COMPLETED = _constants.HV_MIGRATION_COMPLETED
HV_MIGRATION_ACTIVE = _constants.HV_MIGRATION_ACTIVE
HV_MIGRATION_FAILED = _constants.HV_MIGRATION_FAILED
HV_MIGRATION_CANCELLED = _constants.HV_MIGRATION_CANCELLED
HV_MIGRATION_VALID_STATUSES = _constants.HV_MIGRATION_VALID_STATUSES
HV_MIGRATION_FAILED_STATUSES = _constants.HV_MIGRATION_FAILED_STATUSES
HV_KVM_MIGRATION_VALID_STATUSES = _constants.HV_KVM_MIGRATION_VALID_STATUSES

HV_NODEINFO_KEY_VERSION = _constants.HV_NODEINFO_KEY_VERSION

HVST_MEMORY_TOTAL = _constants.HVST_MEMORY_TOTAL
HVST_MEMORY_NODE = _constants.HVST_MEMORY_NODE
HVST_MEMORY_HV = _constants.HVST_MEMORY_HV
HVST_CPU_TOTAL = _constants.HVST_CPU_TOTAL
HVST_CPU_NODE = _constants.HVST_CPU_NODE
HVSTS_PARAMETERS = _constants.HVSTS_PARAMETERS
HVST_DEFAULTS = _constants.HVST_DEFAULTS
HVSTS_PARAMETER_TYPES = _constants.HVSTS_PARAMETER_TYPES

DS_DISK_TOTAL = _constants.DS_DISK_TOTAL
DS_DISK_RESERVED = _constants.DS_DISK_RESERVED
DS_DISK_OVERHEAD = _constants.DS_DISK_OVERHEAD
DS_DEFAULTS = _constants.DS_DEFAULTS
DSS_PARAMETER_TYPES = _constants.DSS_PARAMETER_TYPES
DSS_PARAMETERS = _constants.DSS_PARAMETERS
DS_VALID_TYPES = _constants.DS_VALID_TYPES

BE_MEMORY = _constants.BE_MEMORY
BE_MAXMEM = _constants.BE_MAXMEM
BE_MINMEM = _constants.BE_MINMEM
BE_VCPUS = _constants.BE_VCPUS
BE_AUTO_BALANCE = _constants.BE_AUTO_BALANCE
BE_ALWAYS_FAILOVER = _constants.BE_ALWAYS_FAILOVER
BE_SPINDLE_USE = _constants.BE_SPINDLE_USE
BES_PARAMETER_TYPES = _constants.BES_PARAMETER_TYPES
BES_PARAMETER_TITLES = _constants.BES_PARAMETER_TITLES
BES_PARAMETER_COMPAT = _constants.BES_PARAMETER_COMPAT
BES_PARAMETERS = _constants.BES_PARAMETERS

ISPEC_MEM_SIZE = _constants.ISPEC_MEM_SIZE
ISPEC_CPU_COUNT = _constants.ISPEC_CPU_COUNT
ISPEC_DISK_COUNT = _constants.ISPEC_DISK_COUNT
ISPEC_DISK_SIZE = _constants.ISPEC_DISK_SIZE
ISPEC_NIC_COUNT = _constants.ISPEC_NIC_COUNT
ISPEC_SPINDLE_USE = _constants.ISPEC_SPINDLE_USE
ISPECS_PARAMETER_TYPES = _constants.ISPECS_PARAMETER_TYPES
ISPECS_PARAMETERS = _constants.ISPECS_PARAMETERS

ISPECS_MINMAX = _constants.ISPECS_MINMAX
ISPECS_MIN = _constants.ISPECS_MIN
ISPECS_MAX = _constants.ISPECS_MAX
ISPECS_STD = _constants.ISPECS_STD
IPOLICY_DTS = _constants.IPOLICY_DTS
IPOLICY_VCPU_RATIO = _constants.IPOLICY_VCPU_RATIO
IPOLICY_SPINDLE_RATIO = _constants.IPOLICY_SPINDLE_RATIO
ISPECS_MINMAX_KEYS = _constants.ISPECS_MINMAX_KEYS
IPOLICY_PARAMETERS = _constants.IPOLICY_PARAMETERS
IPOLICY_ALL_KEYS = _constants.IPOLICY_ALL_KEYS

ND_OOB_PROGRAM = _constants.ND_OOB_PROGRAM
ND_SPINDLE_COUNT = _constants.ND_SPINDLE_COUNT
ND_EXCLUSIVE_STORAGE = _constants.ND_EXCLUSIVE_STORAGE
ND_OVS = _constants.ND_OVS
ND_OVS_NAME = _constants.ND_OVS_NAME
ND_OVS_LINK = _constants.ND_OVS_LINK

NDS_PARAMETER_TYPES = _constants.NDS_PARAMETER_TYPES
NDS_PARAMETERS = _constants.NDS_PARAMETERS
NDS_PARAMETER_TITLES = _constants.NDS_PARAMETER_TITLES

LDP_RESYNC_RATE = _constants.LDP_RESYNC_RATE
LDP_STRIPES = _constants.LDP_STRIPES
LDP_BARRIERS = _constants.LDP_BARRIERS
LDP_NO_META_FLUSH = _constants.LDP_NO_META_FLUSH
LDP_DEFAULT_METAVG = _constants.LDP_DEFAULT_METAVG
LDP_DISK_CUSTOM = _constants.LDP_DISK_CUSTOM
LDP_NET_CUSTOM = _constants.LDP_NET_CUSTOM
LDP_PROTOCOL = _constants.LDP_PROTOCOL
LDP_DYNAMIC_RESYNC = _constants.LDP_DYNAMIC_RESYNC
LDP_PLAN_AHEAD = _constants.LDP_PLAN_AHEAD
LDP_FILL_TARGET = _constants.LDP_FILL_TARGET
LDP_DELAY_TARGET = _constants.LDP_DELAY_TARGET
LDP_MAX_RATE = _constants.LDP_MAX_RATE
LDP_MIN_RATE = _constants.LDP_MIN_RATE
LDP_POOL = _constants.LDP_POOL
LDP_ACCESS = _constants.LDP_ACCESS
DISK_LD_TYPES = _constants.DISK_LD_TYPES
DISK_LD_PARAMETERS = _constants.DISK_LD_PARAMETERS

DRBD_RESYNC_RATE = _constants.DRBD_RESYNC_RATE
DRBD_DATA_STRIPES = _constants.DRBD_DATA_STRIPES
DRBD_META_STRIPES = _constants.DRBD_META_STRIPES
DRBD_DISK_BARRIERS = _constants.DRBD_DISK_BARRIERS
DRBD_META_BARRIERS = _constants.DRBD_META_BARRIERS
DRBD_DEFAULT_METAVG = _constants.DRBD_DEFAULT_METAVG
DRBD_DISK_CUSTOM = _constants.DRBD_DISK_CUSTOM
DRBD_NET_CUSTOM = _constants.DRBD_NET_CUSTOM
DRBD_PROTOCOL = _constants.DRBD_PROTOCOL
DRBD_DYNAMIC_RESYNC = _constants.DRBD_DYNAMIC_RESYNC
DRBD_PLAN_AHEAD = _constants.DRBD_PLAN_AHEAD
DRBD_FILL_TARGET = _constants.DRBD_FILL_TARGET
DRBD_DELAY_TARGET = _constants.DRBD_DELAY_TARGET
DRBD_MAX_RATE = _constants.DRBD_MAX_RATE
DRBD_MIN_RATE = _constants.DRBD_MIN_RATE
LV_STRIPES = _constants.LV_STRIPES
RBD_ACCESS = _constants.RBD_ACCESS
RBD_POOL = _constants.RBD_POOL
DISK_DT_TYPES = _constants.DISK_DT_TYPES
DISK_DT_PARAMETERS = _constants.DISK_DT_PARAMETERS

DDP_LOCAL_IP = _constants.DDP_LOCAL_IP
DDP_REMOTE_IP = _constants.DDP_REMOTE_IP
DDP_PORT = _constants.DDP_PORT
DDP_LOCAL_MINOR = _constants.DDP_LOCAL_MINOR
DDP_REMOTE_MINOR = _constants.DDP_REMOTE_MINOR

OOB_POWER_ON = _constants.OOB_POWER_ON
OOB_POWER_OFF = _constants.OOB_POWER_OFF
OOB_POWER_CYCLE = _constants.OOB_POWER_CYCLE
OOB_POWER_STATUS = _constants.OOB_POWER_STATUS
OOB_HEALTH = _constants.OOB_HEALTH
OOB_COMMANDS = _constants.OOB_COMMANDS

OOB_POWER_STATUS_POWERED = _constants.OOB_POWER_STATUS_POWERED

OOB_TIMEOUT = _constants.OOB_TIMEOUT
OOB_POWER_DELAY = _constants.OOB_POWER_DELAY

OOB_STATUS_OK = _constants.OOB_STATUS_OK
OOB_STATUS_WARNING = _constants.OOB_STATUS_WARNING
OOB_STATUS_CRITICAL = _constants.OOB_STATUS_CRITICAL
OOB_STATUS_UNKNOWN = _constants.OOB_STATUS_UNKNOWN
OOB_STATUSES = _constants.OOB_STATUSES

PP_DEFAULT = _constants.PP_DEFAULT

NIC_MODE = _constants.NIC_MODE
NIC_LINK = _constants.NIC_LINK
NIC_VLAN = _constants.NIC_VLAN
NICS_PARAMETER_TYPES = _constants.NICS_PARAMETER_TYPES
NICS_PARAMETERS = _constants.NICS_PARAMETERS

NIC_MODE_BRIDGED = _constants.NIC_MODE_BRIDGED
NIC_MODE_ROUTED = _constants.NIC_MODE_ROUTED
NIC_MODE_OVS = _constants.NIC_MODE_OVS
NIC_IP_POOL = _constants.NIC_IP_POOL
NIC_VALID_MODES = _constants.NIC_VALID_MODES

RESERVE_ACTION = _constants.RESERVE_ACTION
RELEASE_ACTION = _constants.RELEASE_ACTION

IDISK_SIZE = _constants.IDISK_SIZE
IDISK_SPINDLES = _constants.IDISK_SPINDLES
IDISK_MODE = _constants.IDISK_MODE
IDISK_ADOPT = _constants.IDISK_ADOPT
IDISK_VG = _constants.IDISK_VG
IDISK_METAVG = _constants.IDISK_METAVG
IDISK_PROVIDER = _constants.IDISK_PROVIDER
IDISK_NAME = _constants.IDISK_NAME
IDISK_PARAMS_TYPES = _constants.IDISK_PARAMS_TYPES
IDISK_PARAMS = _constants.IDISK_PARAMS

INIC_MAC = _constants.INIC_MAC
INIC_IP = _constants.INIC_IP
INIC_MODE = _constants.INIC_MODE
INIC_LINK = _constants.INIC_LINK
INIC_NETWORK = _constants.INIC_NETWORK
INIC_NAME = _constants.INIC_NAME
INIC_VLAN = _constants.INIC_VLAN
INIC_BRIDGE = _constants.INIC_BRIDGE
INIC_PARAMS_TYPES = _constants.INIC_PARAMS_TYPES
INIC_PARAMS = _constants.INIC_PARAMS

HT_XEN_PVM = _constants.HT_XEN_PVM
HT_FAKE = _constants.HT_FAKE
HT_XEN_HVM = _constants.HT_XEN_HVM
HT_KVM = _constants.HT_KVM
HT_CHROOT = _constants.HT_CHROOT
HT_LXC = _constants.HT_LXC
HYPER_TYPES = _constants.HYPER_TYPES
HTS_REQ_PORT = _constants.HTS_REQ_PORT

VNC_BASE_PORT = _constants.VNC_BASE_PORT
VNC_DEFAULT_BIND_ADDRESS = _constants.VNC_DEFAULT_BIND_ADDRESS

HT_NIC_RTL8139 = _constants.HT_NIC_RTL8139
HT_NIC_NE2K_PCI = _constants.HT_NIC_NE2K_PCI
HT_NIC_NE2K_ISA = _constants.HT_NIC_NE2K_ISA
HT_NIC_I82551 = _constants.HT_NIC_I82551
HT_NIC_I85557B = _constants.HT_NIC_I85557B
HT_NIC_I8259ER = _constants.HT_NIC_I8259ER
HT_NIC_PCNET = _constants.HT_NIC_PCNET
HT_NIC_E1000 = _constants.HT_NIC_E1000
HT_NIC_PARAVIRTUAL = _constants.HT_NIC_PARAVIRTUAL
HT_HVM_VALID_NIC_TYPES = _constants.HT_HVM_VALID_NIC_TYPES
HT_KVM_VALID_NIC_TYPES = _constants.HT_KVM_VALID_NIC_TYPES

HT_HVM_VIF_IOEMU = _constants.HT_HVM_VIF_IOEMU
HT_HVM_VIF_VIF = _constants.HT_HVM_VIF_VIF
HT_HVM_VALID_VIF_TYPES = _constants.HT_HVM_VALID_VIF_TYPES

HT_DISK_IOEMU = _constants.HT_DISK_IOEMU
HT_DISK_IDE = _constants.HT_DISK_IDE
HT_DISK_SCSI = _constants.HT_DISK_SCSI
HT_DISK_SD = _constants.HT_DISK_SD
HT_DISK_MTD = _constants.HT_DISK_MTD
HT_DISK_PFLASH = _constants.HT_DISK_PFLASH
HT_DISK_PARAVIRTUAL = _constants.HT_DISK_PARAVIRTUAL
HT_HVM_VALID_DISK_TYPES = _constants.HT_HVM_VALID_DISK_TYPES
HT_KVM_VALID_DISK_TYPES = _constants.HT_KVM_VALID_DISK_TYPES

HT_CACHE_DEFAULT = _constants.HT_CACHE_DEFAULT
HT_CACHE_NONE = _constants.HT_CACHE_NONE
HT_CACHE_WTHROUGH = _constants.HT_CACHE_WTHROUGH
HT_CACHE_WBACK = _constants.HT_CACHE_WBACK
HT_VALID_CACHE_TYPES = _constants.HT_VALID_CACHE_TYPES

HT_MOUSE_MOUSE = _constants.HT_MOUSE_MOUSE
HT_MOUSE_TABLET = _constants.HT_MOUSE_TABLET
HT_KVM_VALID_MOUSE_TYPES = _constants.HT_KVM_VALID_MOUSE_TYPES

HT_BO_FLOPPY = _constants.HT_BO_FLOPPY
HT_BO_CDROM = _constants.HT_BO_CDROM
HT_BO_DISK = _constants.HT_BO_DISK
HT_BO_NETWORK = _constants.HT_BO_NETWORK
HT_KVM_VALID_BO_TYPES = _constants.HT_KVM_VALID_BO_TYPES

HT_KVM_SPICE_LOSSLESS_IMG_COMPR_AUTO_GLZ = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_AUTO_GLZ
HT_KVM_SPICE_LOSSLESS_IMG_COMPR_AUTO_LZ = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_AUTO_LZ
HT_KVM_SPICE_LOSSLESS_IMG_COMPR_QUIC = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_QUIC
HT_KVM_SPICE_LOSSLESS_IMG_COMPR_GLZ = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_GLZ
HT_KVM_SPICE_LOSSLESS_IMG_COMPR_LZ = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_LZ
HT_KVM_SPICE_LOSSLESS_IMG_COMPR_OFF = \
  _constants.HT_KVM_SPICE_LOSSLESS_IMG_COMPR_OFF
HT_KVM_SPICE_VALID_LOSSLESS_IMG_COMPR_OPTIONS = \
  _constants.HT_KVM_SPICE_VALID_LOSSLESS_IMG_COMPR_OPTIONS

HT_KVM_SPICE_LOSSY_IMG_COMPR_AUTO = _constants.HT_KVM_SPICE_LOSSY_IMG_COMPR_AUTO
HT_KVM_SPICE_LOSSY_IMG_COMPR_NEVER = \
  _constants.HT_KVM_SPICE_LOSSY_IMG_COMPR_NEVER
HT_KVM_SPICE_LOSSY_IMG_COMPR_ALWAYS = \
  _constants.HT_KVM_SPICE_LOSSY_IMG_COMPR_ALWAYS

HT_KVM_SPICE_VALID_LOSSY_IMG_COMPR_OPTIONS = \
  _constants.HT_KVM_SPICE_VALID_LOSSY_IMG_COMPR_OPTIONS

HT_KVM_SPICE_VIDEO_STREAM_DETECTION_OFF = \
  _constants.HT_KVM_SPICE_VIDEO_STREAM_DETECTION_OFF
HT_KVM_SPICE_VIDEO_STREAM_DETECTION_ALL = \
  _constants.HT_KVM_SPICE_VIDEO_STREAM_DETECTION_ALL
HT_KVM_SPICE_VIDEO_STREAM_DETECTION_FILTER = \
  _constants.HT_KVM_SPICE_VIDEO_STREAM_DETECTION_FILTER
HT_KVM_SPICE_VALID_VIDEO_STREAM_DETECTION_OPTIONS = \
  _constants.HT_KVM_SPICE_VALID_VIDEO_STREAM_DETECTION_OPTIONS

HT_SM_NONE = _constants.HT_SM_NONE
HT_SM_USER = _constants.HT_SM_USER
HT_SM_POOL = _constants.HT_SM_POOL
HT_KVM_VALID_SM_TYPES = _constants.HT_KVM_VALID_SM_TYPES

HT_KVM_ENABLED = _constants.HT_KVM_ENABLED
HT_KVM_DISABLED = _constants.HT_KVM_DISABLED
HT_KVM_FLAG_VALUES = _constants.HT_KVM_FLAG_VALUES

HT_MIGRATION_LIVE = _constants.HT_MIGRATION_LIVE
HT_MIGRATION_NONLIVE = _constants.HT_MIGRATION_NONLIVE
HT_MIGRATION_MODES = _constants.HT_MIGRATION_MODES

VERIFY_NPLUSONE_MEM = _constants.VERIFY_NPLUSONE_MEM
VERIFY_OPTIONAL_CHECKS = _constants.VERIFY_OPTIONAL_CHECKS

CV_TCLUSTER = _constants.CV_TCLUSTER
CV_TGROUP = _constants.CV_TGROUP
CV_TNODE = _constants.CV_TNODE
CV_TINSTANCE = _constants.CV_TINSTANCE

CV_ECLUSTERCFG = _constants.CV_ECLUSTERCFG
CV_ECLUSTERCERT = _constants.CV_ECLUSTERCERT
CV_ECLUSTERFILECHECK = _constants.CV_ECLUSTERFILECHECK
CV_ECLUSTERDANGLINGNODES = _constants.CV_ECLUSTERDANGLINGNODES
CV_ECLUSTERDANGLINGINST = _constants.CV_ECLUSTERDANGLINGINST
CV_EGROUPDIFFERENTPVSIZE = _constants.CV_EGROUPDIFFERENTPVSIZE
CV_EINSTANCEBADNODE = _constants.CV_EINSTANCEBADNODE
CV_EINSTANCEDOWN = _constants.CV_EINSTANCEDOWN
CV_EINSTANCELAYOUT = _constants.CV_EINSTANCELAYOUT
CV_EINSTANCEMISSINGDISK = _constants.CV_EINSTANCEMISSINGDISK
CV_EINSTANCEFAULTYDISK = _constants.CV_EINSTANCEFAULTYDISK
CV_EINSTANCEWRONGNODE = _constants.CV_EINSTANCEWRONGNODE
CV_EINSTANCESPLITGROUPS = _constants.CV_EINSTANCESPLITGROUPS
CV_EINSTANCEPOLICY = _constants.CV_EINSTANCEPOLICY
CV_EINSTANCEUNSUITABLENODE = _constants.CV_EINSTANCEUNSUITABLENODE
CV_EINSTANCEMISSINGCFGPARAMETER = _constants.CV_EINSTANCEMISSINGCFGPARAMETER
CV_ENODEDRBD = _constants.CV_ENODEDRBD
CV_ENODEDRBDVERSION = _constants.CV_ENODEDRBDVERSION
CV_ENODEDRBDHELPER = _constants.CV_ENODEDRBDHELPER
CV_ENODEFILECHECK = _constants.CV_ENODEFILECHECK
CV_ENODEHOOKS = _constants.CV_ENODEHOOKS
CV_ENODEHV = _constants.CV_ENODEHV
CV_ENODELVM = _constants.CV_ENODELVM
CV_ENODEN1 = _constants.CV_ENODEN1
CV_ENODENET = _constants.CV_ENODENET
CV_ENODEOS = _constants.CV_ENODEOS
CV_ENODEORPHANINSTANCE = _constants.CV_ENODEORPHANINSTANCE
CV_ENODEORPHANLV = _constants.CV_ENODEORPHANLV
CV_ENODERPC = _constants.CV_ENODERPC
CV_ENODESSH = _constants.CV_ENODESSH
CV_ENODEVERSION = _constants.CV_ENODEVERSION
CV_ENODESETUP = _constants.CV_ENODESETUP
CV_ENODETIME = _constants.CV_ENODETIME
CV_ENODEOOBPATH = _constants.CV_ENODEOOBPATH
CV_ENODEUSERSCRIPTS = _constants.CV_ENODEUSERSCRIPTS
CV_ENODEFILESTORAGEPATHS = _constants.CV_ENODEFILESTORAGEPATHS
CV_ENODEFILESTORAGEPATHUNUSABLE = _constants.CV_ENODEFILESTORAGEPATHUNUSABLE
CV_ENODESHAREDFILESTORAGEPATHUNUSABLE = \
  _constants.CV_ENODESHAREDFILESTORAGEPATHUNUSABLE

CV_ALL_ECODES = _constants.CV_ALL_ECODES
CV_ALL_ECODES_STRINGS = _constants.CV_ALL_ECODES_STRINGS

NV_BRIDGES = _constants.NV_BRIDGES
NV_DRBDHELPER = _constants.NV_DRBDHELPER
NV_DRBDVERSION = _constants.NV_DRBDVERSION
NV_DRBDLIST = _constants.NV_DRBDLIST
NV_EXCLUSIVEPVS = _constants.NV_EXCLUSIVEPVS
NV_FILELIST = _constants.NV_FILELIST
NV_ACCEPTED_STORAGE_PATHS = _constants.NV_ACCEPTED_STORAGE_PATHS
NV_FILE_STORAGE_PATH = _constants.NV_FILE_STORAGE_PATH
NV_SHARED_FILE_STORAGE_PATH = _constants.NV_SHARED_FILE_STORAGE_PATH
NV_HVINFO = _constants.NV_HVINFO
NV_HVPARAMS = _constants.NV_HVPARAMS
NV_HYPERVISOR = _constants.NV_HYPERVISOR
NV_INSTANCELIST = _constants.NV_INSTANCELIST
NV_LVLIST = _constants.NV_LVLIST
NV_MASTERIP = _constants.NV_MASTERIP
NV_NODELIST = _constants.NV_NODELIST
NV_NODENETTEST = _constants.NV_NODENETTEST
NV_NODESETUP = _constants.NV_NODESETUP
NV_OOB_PATHS = _constants.NV_OOB_PATHS
NV_OSLIST = _constants.NV_OSLIST
NV_PVLIST = _constants.NV_PVLIST
NV_TIME = _constants.NV_TIME
NV_USERSCRIPTS = _constants.NV_USERSCRIPTS
NV_VERSION = _constants.NV_VERSION
NV_VGLIST = _constants.NV_VGLIST
NV_VMNODES = _constants.NV_VMNODES

INSTST_RUNNING = _constants.INSTST_RUNNING
INSTST_ADMINDOWN = _constants.INSTST_ADMINDOWN
INSTST_ADMINOFFLINE = _constants.INSTST_ADMINOFFLINE
INSTST_NODEOFFLINE = _constants.INSTST_NODEOFFLINE
INSTST_NODEDOWN = _constants.INSTST_NODEDOWN
INSTST_WRONGNODE = _constants.INSTST_WRONGNODE
INSTST_ERRORUP = _constants.INSTST_ERRORUP
INSTST_ERRORDOWN = _constants.INSTST_ERRORDOWN
INSTST_ALL = _constants.INSTST_ALL

ADMINST_UP = _constants.ADMINST_UP
ADMINST_DOWN = _constants.ADMINST_DOWN
ADMINST_OFFLINE = _constants.ADMINST_OFFLINE
ADMINST_ALL = _constants.ADMINST_ALL

NR_REGULAR = _constants.NR_REGULAR
NR_MASTER = _constants.NR_MASTER
NR_MCANDIDATE = _constants.NR_MCANDIDATE
NR_DRAINED = _constants.NR_DRAINED
NR_OFFLINE = _constants.NR_OFFLINE
NR_ALL = _constants.NR_ALL

SSL_CERT_EXPIRATION_WARN = _constants.SSL_CERT_EXPIRATION_WARN
SSL_CERT_EXPIRATION_ERROR = _constants.SSL_CERT_EXPIRATION_ERROR

IALLOCATOR_VERSION = _constants.IALLOCATOR_VERSION
IALLOCATOR_DIR_IN = _constants.IALLOCATOR_DIR_IN
IALLOCATOR_DIR_OUT = _constants.IALLOCATOR_DIR_OUT
VALID_IALLOCATOR_DIRECTIONS = _constants.VALID_IALLOCATOR_DIRECTIONS

IALLOCATOR_MODE_ALLOC = _constants.IALLOCATOR_MODE_ALLOC
IALLOCATOR_MODE_RELOC = _constants.IALLOCATOR_MODE_RELOC
IALLOCATOR_MODE_CHG_GROUP = _constants.IALLOCATOR_MODE_CHG_GROUP
IALLOCATOR_MODE_NODE_EVAC = _constants.IALLOCATOR_MODE_NODE_EVAC
IALLOCATOR_MODE_MULTI_ALLOC = _constants.IALLOCATOR_MODE_MULTI_ALLOC
VALID_IALLOCATOR_MODES = _constants.VALID_IALLOCATOR_MODES

IALLOCATOR_SEARCH_PATH = _constants.IALLOCATOR_SEARCH_PATH
DEFAULT_IALLOCATOR_SHORTCUT = _constants.DEFAULT_IALLOCATOR_SHORTCUT

NODE_EVAC_PRI = _constants.NODE_EVAC_PRI
NODE_EVAC_SEC = _constants.NODE_EVAC_SEC
NODE_EVAC_ALL = _constants.NODE_EVAC_ALL
NODE_EVAC_MODES = _constants.NODE_EVAC_MODES

JOB_QUEUE_VERSION = _constants.JOB_QUEUE_VERSION
JOB_QUEUE_SIZE_HARD_LIMIT = _constants.JOB_QUEUE_SIZE_HARD_LIMIT
JOB_QUEUE_FILES_PERMS = _constants.JOB_QUEUE_FILES_PERMS

JOB_ID_TEMPLATE = r"\d+"
JOB_FILE_RE = re.compile(r"^job-(%s)$" % JOB_ID_TEMPLATE)

JOB_NOTCHANGED = _constants.JOB_NOTCHANGED

JOB_STATUS_QUEUED = _constants.JOB_STATUS_QUEUED
JOB_STATUS_WAITING = _constants.JOB_STATUS_WAITING
JOB_STATUS_CANCELING = _constants.JOB_STATUS_CANCELING
JOB_STATUS_RUNNING = _constants.JOB_STATUS_RUNNING
JOB_STATUS_CANCELED = _constants.JOB_STATUS_CANCELED
JOB_STATUS_SUCCESS = _constants.JOB_STATUS_SUCCESS
JOB_STATUS_ERROR = _constants.JOB_STATUS_ERROR
JOBS_PENDING = _constants.JOBS_PENDING
JOBS_FINALIZED = _constants.JOBS_FINALIZED
JOB_STATUS_ALL = _constants.JOB_STATUS_ALL

OP_STATUS_QUEUED = _constants.OP_STATUS_QUEUED
OP_STATUS_WAITING = _constants.OP_STATUS_WAITING
OP_STATUS_CANCELING = _constants.OP_STATUS_CANCELING
OP_STATUS_RUNNING = _constants.OP_STATUS_RUNNING
OP_STATUS_CANCELED = _constants.OP_STATUS_CANCELED
OP_STATUS_SUCCESS = _constants.OP_STATUS_SUCCESS
OP_STATUS_ERROR = _constants.OP_STATUS_ERROR
OPS_FINALIZED = _constants.OPS_FINALIZED

OP_PRIO_LOWEST = _constants.OP_PRIO_LOWEST
OP_PRIO_HIGHEST = _constants.OP_PRIO_HIGHEST
OP_PRIO_LOW = _constants.OP_PRIO_LOW
OP_PRIO_NORMAL = _constants.OP_PRIO_NORMAL
OP_PRIO_HIGH = _constants.OP_PRIO_HIGH
OP_PRIO_SUBMIT_VALID = _constants.OP_PRIO_SUBMIT_VALID
OP_PRIO_DEFAULT = _constants.OP_PRIO_DEFAULT

LOCKS_REPLACE = _constants.LOCKS_REPLACE
LOCKS_APPEND = _constants.LOCKS_APPEND

LOCK_ATTEMPTS_TIMEOUT = _constants.LOCK_ATTEMPTS_TIMEOUT
LOCK_ATTEMPTS_MAXWAIT = _constants.LOCK_ATTEMPTS_MAXWAIT
LOCK_ATTEMPTS_MINWAIT = _constants.LOCK_ATTEMPTS_MINWAIT

ELOG_MESSAGE = _constants.ELOG_MESSAGE
ELOG_REMOTE_IMPORT = _constants.ELOG_REMOTE_IMPORT
ELOG_JQUEUE_TEST = _constants.ELOG_JQUEUE_TEST

ETC_HOSTS_ADD = _constants.ETC_HOSTS_ADD
ETC_HOSTS_REMOVE = _constants.ETC_HOSTS_REMOVE

JQT_MSGPREFIX = _constants.JQT_MSGPREFIX
JQT_EXPANDNAMES = _constants.JQT_EXPANDNAMES
JQT_EXEC = _constants.JQT_EXEC
JQT_LOGMSG = _constants.JQT_LOGMSG
JQT_STARTMSG = _constants.JQT_STARTMSG
JQT_ALL = _constants.JQT_ALL

QR_CLUSTER = _constants.QR_CLUSTER
QR_INSTANCE = _constants.QR_INSTANCE
QR_NODE = _constants.QR_NODE
QR_LOCK = _constants.QR_LOCK
QR_GROUP = _constants.QR_GROUP
QR_OS = _constants.QR_OS
QR_JOB = _constants.QR_JOB
QR_EXPORT = _constants.QR_EXPORT
QR_NETWORK = _constants.QR_NETWORK
QR_EXTSTORAGE = _constants.QR_EXTSTORAGE
QR_VIA_OP = _constants.QR_VIA_OP
QR_VIA_LUXI = _constants.QR_VIA_LUXI
QR_VIA_RAPI = _constants.QR_VIA_RAPI

QFT_UNKNOWN = _constants.QFT_UNKNOWN
QFT_TEXT = _constants.QFT_TEXT
QFT_BOOL = _constants.QFT_BOOL
QFT_NUMBER = _constants.QFT_NUMBER
QFT_UNIT = _constants.QFT_UNIT
QFT_TIMESTAMP = _constants.QFT_TIMESTAMP
QFT_OTHER = _constants.QFT_OTHER
QFT_ALL = _constants.QFT_ALL

RS_NORMAL = _constants.RS_NORMAL
RS_UNKNOWN = _constants.RS_UNKNOWN
RS_NODATA = _constants.RS_NODATA
RS_UNAVAIL = _constants.RS_UNAVAIL
RS_OFFLINE = _constants.RS_OFFLINE
RS_ALL = _constants.RS_ALL
RSS_DESCRIPTION = _constants.RSS_DESCRIPTION

MAX_NICS = _constants.MAX_NICS
MAX_DISKS = _constants.MAX_DISKS

SSCONF_FILEPREFIX = _constants.SSCONF_FILEPREFIX

SS_CLUSTER_NAME = _constants.SS_CLUSTER_NAME
SS_CLUSTER_TAGS = _constants.SS_CLUSTER_TAGS
SS_FILE_STORAGE_DIR = _constants.SS_FILE_STORAGE_DIR
SS_SHARED_FILE_STORAGE_DIR = _constants.SS_SHARED_FILE_STORAGE_DIR
SS_MASTER_CANDIDATES = _constants.SS_MASTER_CANDIDATES
SS_MASTER_CANDIDATES_IPS = _constants.SS_MASTER_CANDIDATES_IPS
SS_MASTER_IP = _constants.SS_MASTER_IP
SS_MASTER_NETDEV = _constants.SS_MASTER_NETDEV
SS_MASTER_NETMASK = _constants.SS_MASTER_NETMASK
SS_MASTER_NODE = _constants.SS_MASTER_NODE
SS_NODE_LIST = _constants.SS_NODE_LIST
SS_NODE_PRIMARY_IPS = _constants.SS_NODE_PRIMARY_IPS
SS_NODE_SECONDARY_IPS = _constants.SS_NODE_SECONDARY_IPS
SS_OFFLINE_NODES = _constants.SS_OFFLINE_NODES
SS_ONLINE_NODES = _constants.SS_ONLINE_NODES
SS_PRIMARY_IP_FAMILY = _constants.SS_PRIMARY_IP_FAMILY
SS_INSTANCE_LIST = _constants.SS_INSTANCE_LIST
SS_RELEASE_VERSION = _constants.SS_RELEASE_VERSION
SS_HYPERVISOR_LIST = _constants.SS_HYPERVISOR_LIST
SS_MAINTAIN_NODE_HEALTH = _constants.SS_MAINTAIN_NODE_HEALTH
SS_UID_POOL = _constants.SS_UID_POOL
SS_NODEGROUPS = _constants.SS_NODEGROUPS
SS_NETWORKS = _constants.SS_NETWORKS

SS_HVPARAMS_PREF = _constants.SS_HVPARAMS_PREF

SS_HVPARAMS_XEN_PVM = _constants.SS_HVPARAMS_XEN_PVM
SS_HVPARAMS_XEN_FAKE = _constants.SS_HVPARAMS_XEN_FAKE
SS_HVPARAMS_XEN_HVM = _constants.SS_HVPARAMS_XEN_HVM
SS_HVPARAMS_XEN_KVM = _constants.SS_HVPARAMS_XEN_KVM
SS_HVPARAMS_XEN_CHROOT = _constants.SS_HVPARAMS_XEN_CHROOT
SS_HVPARAMS_XEN_LXC = _constants.SS_HVPARAMS_XEN_LXC
VALID_SS_HVPARAMS_KEYS = _constants.VALID_SS_HVPARAMS_KEYS

SS_FILE_PERMS = _constants.SS_FILE_PERMS

DEFAULT_ENABLED_HYPERVISOR = _constants.DEFAULT_ENABLED_HYPERVISOR

HVC_DEFAULTS = {
  HT_XEN_PVM: {
    HV_USE_BOOTLOADER: False,
    HV_BOOTLOADER_PATH: XEN_BOOTLOADER,
    HV_BOOTLOADER_ARGS: "",
    HV_KERNEL_PATH: XEN_KERNEL,
    HV_INITRD_PATH: "",
    HV_ROOT_PATH: "/dev/xvda1",
    HV_KERNEL_ARGS: "ro",
    HV_MIGRATION_PORT: 8002,
    HV_MIGRATION_MODE: HT_MIGRATION_LIVE,
    HV_BLOCKDEV_PREFIX: "sd",
    HV_REBOOT_BEHAVIOR: INSTANCE_REBOOT_ALLOWED,
    HV_CPU_MASK: CPU_PINNING_ALL,
    HV_CPU_CAP: 0,
    HV_CPU_WEIGHT: 256,
    HV_VIF_SCRIPT: "",
    HV_XEN_CMD: XEN_CMD_XM,
    HV_XEN_CPUID: "",
    HV_SOUNDHW: "",
    },
  HT_XEN_HVM: {
    HV_BOOT_ORDER: "cd",
    HV_CDROM_IMAGE_PATH: "",
    HV_NIC_TYPE: HT_NIC_RTL8139,
    HV_DISK_TYPE: HT_DISK_PARAVIRTUAL,
    HV_VNC_BIND_ADDRESS: IP4_ADDRESS_ANY,
    HV_VNC_PASSWORD_FILE: pathutils.VNC_PASSWORD_FILE,
    HV_ACPI: True,
    HV_PAE: True,
    HV_KERNEL_PATH: "/usr/lib/xen/boot/hvmloader",
    HV_DEVICE_MODEL: "/usr/lib/xen/bin/qemu-dm",
    HV_MIGRATION_PORT: 8002,
    HV_MIGRATION_MODE: HT_MIGRATION_NONLIVE,
    HV_USE_LOCALTIME: False,
    HV_BLOCKDEV_PREFIX: "hd",
    HV_PASSTHROUGH: "",
    HV_REBOOT_BEHAVIOR: INSTANCE_REBOOT_ALLOWED,
    HV_CPU_MASK: CPU_PINNING_ALL,
    HV_CPU_CAP: 0,
    HV_CPU_WEIGHT: 256,
    HV_VIF_TYPE: HT_HVM_VIF_IOEMU,
    HV_VIF_SCRIPT: "",
    HV_VIRIDIAN: False,
    HV_XEN_CMD: XEN_CMD_XM,
    HV_XEN_CPUID: "",
    HV_SOUNDHW: "",
    },
  HT_KVM: {
    HV_KVM_PATH: KVM_PATH,
    HV_KERNEL_PATH: KVM_KERNEL,
    HV_INITRD_PATH: "",
    HV_KERNEL_ARGS: "ro",
    HV_ROOT_PATH: "/dev/vda1",
    HV_ACPI: True,
    HV_SERIAL_CONSOLE: True,
    HV_SERIAL_SPEED: 38400,
    HV_VNC_BIND_ADDRESS: "",
    HV_VNC_TLS: False,
    HV_VNC_X509: "",
    HV_VNC_X509_VERIFY: False,
    HV_VNC_PASSWORD_FILE: "",
    HV_KVM_SPICE_BIND: "",
    HV_KVM_SPICE_IP_VERSION: IFACE_NO_IP_VERSION_SPECIFIED,
    HV_KVM_SPICE_PASSWORD_FILE: "",
    HV_KVM_SPICE_LOSSLESS_IMG_COMPR: "",
    HV_KVM_SPICE_JPEG_IMG_COMPR: "",
    HV_KVM_SPICE_ZLIB_GLZ_IMG_COMPR: "",
    HV_KVM_SPICE_STREAMING_VIDEO_DETECTION: "",
    HV_KVM_SPICE_AUDIO_COMPR: True,
    HV_KVM_SPICE_USE_TLS: False,
    HV_KVM_SPICE_TLS_CIPHERS: OPENSSL_CIPHERS,
    HV_KVM_SPICE_USE_VDAGENT: True,
    HV_KVM_FLOPPY_IMAGE_PATH: "",
    HV_CDROM_IMAGE_PATH: "",
    HV_KVM_CDROM2_IMAGE_PATH: "",
    HV_BOOT_ORDER: HT_BO_DISK,
    HV_NIC_TYPE: HT_NIC_PARAVIRTUAL,
    HV_DISK_TYPE: HT_DISK_PARAVIRTUAL,
    HV_KVM_CDROM_DISK_TYPE: "",
    HV_USB_MOUSE: "",
    HV_KEYMAP: "",
    HV_MIGRATION_PORT: 8102,
    HV_MIGRATION_BANDWIDTH: 32, # MiB/s
    HV_MIGRATION_DOWNTIME: 30,  # ms
    HV_MIGRATION_MODE: HT_MIGRATION_LIVE,
    HV_USE_LOCALTIME: False,
    HV_DISK_CACHE: HT_CACHE_DEFAULT,
    HV_SECURITY_MODEL: HT_SM_NONE,
    HV_SECURITY_DOMAIN: "",
    HV_KVM_FLAG: "",
    HV_VHOST_NET: False,
    HV_KVM_USE_CHROOT: False,
    HV_MEM_PATH: "",
    HV_REBOOT_BEHAVIOR: INSTANCE_REBOOT_ALLOWED,
    HV_CPU_MASK: CPU_PINNING_ALL,
    HV_CPU_TYPE: "",
    HV_CPU_CORES: 0,
    HV_CPU_THREADS: 0,
    HV_CPU_SOCKETS: 0,
    HV_SOUNDHW: "",
    HV_USB_DEVICES: "",
    HV_VGA: "",
    HV_KVM_EXTRA: "",
    HV_KVM_MACHINE_VERSION: "",
    HV_VNET_HDR: True,
    },
  HT_FAKE: {
    HV_MIGRATION_MODE: HT_MIGRATION_LIVE,
  },
  HT_CHROOT: {
    HV_INIT_SCRIPT: "/ganeti-chroot",
    },
  HT_LXC: {
    HV_CPU_MASK: "",
    },
  }

HVC_GLOBALS = _constants.HVC_GLOBALS

BEC_DEFAULTS = {
  BE_MINMEM: 128,
  BE_MAXMEM: 128,
  BE_VCPUS: 1,
  BE_AUTO_BALANCE: True,
  BE_ALWAYS_FAILOVER: False,
  BE_SPINDLE_USE: 1,
  }

NDC_DEFAULTS = {
  ND_OOB_PROGRAM: "",
  ND_SPINDLE_COUNT: 1,
  ND_EXCLUSIVE_STORAGE: False,
  ND_OVS: False,
  ND_OVS_NAME: DEFAULT_OVS,
  ND_OVS_LINK: ""
  }

NDC_GLOBALS = _constants.NDC_GLOBALS

DISK_LD_DEFAULTS = {
  DT_DRBD8: {
    LDP_RESYNC_RATE: CLASSIC_DRBD_SYNC_SPEED,
    LDP_BARRIERS: _constants.DRBD_BARRIERS,
    LDP_NO_META_FLUSH: _constants.DRBD_NO_META_FLUSH,
    LDP_DEFAULT_METAVG: DEFAULT_VG,
    LDP_DISK_CUSTOM: "",
    LDP_NET_CUSTOM: "",
    LDP_PROTOCOL: DRBD_DEFAULT_NET_PROTOCOL,
    LDP_DYNAMIC_RESYNC: False,

    # The default values for the DRBD dynamic resync speed algorithm
    # are taken from the drbsetup 8.3.11 man page, except for
    # c-plan-ahead (that we don't need to set to 0, because we have a
    # separate option to enable it) and for c-max-rate, that we cap to
    # the default value for the static resync rate.
    LDP_PLAN_AHEAD: 20, # ds
    LDP_FILL_TARGET: 0, # sectors
    LDP_DELAY_TARGET: 1, # ds
    LDP_MAX_RATE: CLASSIC_DRBD_SYNC_SPEED, # KiB/s
    LDP_MIN_RATE: 4 * 1024, # KiB/s
    },
  DT_PLAIN: {
    LDP_STRIPES: _constants.LVM_STRIPECOUNT
    },
  DT_FILE: {},
  DT_SHARED_FILE: {},
  DT_BLOCK: {},
  DT_RBD: {
    LDP_POOL: "rbd",
    LDP_ACCESS: DISK_KERNELSPACE,
    },
  DT_EXT: {},
  }

# readability shortcuts
_LV_DEFAULTS = DISK_LD_DEFAULTS[DT_PLAIN]
_DRBD_DEFAULTS = DISK_LD_DEFAULTS[DT_DRBD8]

DISK_DT_DEFAULTS = {
  DT_PLAIN: {
    LV_STRIPES: DISK_LD_DEFAULTS[DT_PLAIN][LDP_STRIPES],
    },
  DT_DRBD8: {
    DRBD_RESYNC_RATE: _DRBD_DEFAULTS[LDP_RESYNC_RATE],
    DRBD_DATA_STRIPES: _LV_DEFAULTS[LDP_STRIPES],
    DRBD_META_STRIPES: _LV_DEFAULTS[LDP_STRIPES],
    DRBD_DISK_BARRIERS: _DRBD_DEFAULTS[LDP_BARRIERS],
    DRBD_META_BARRIERS: _DRBD_DEFAULTS[LDP_NO_META_FLUSH],
    DRBD_DEFAULT_METAVG: _DRBD_DEFAULTS[LDP_DEFAULT_METAVG],
    DRBD_DISK_CUSTOM: _DRBD_DEFAULTS[LDP_DISK_CUSTOM],
    DRBD_NET_CUSTOM: _DRBD_DEFAULTS[LDP_NET_CUSTOM],
    DRBD_PROTOCOL: _DRBD_DEFAULTS[LDP_PROTOCOL],
    DRBD_DYNAMIC_RESYNC: _DRBD_DEFAULTS[LDP_DYNAMIC_RESYNC],
    DRBD_PLAN_AHEAD: _DRBD_DEFAULTS[LDP_PLAN_AHEAD],
    DRBD_FILL_TARGET: _DRBD_DEFAULTS[LDP_FILL_TARGET],
    DRBD_DELAY_TARGET: _DRBD_DEFAULTS[LDP_DELAY_TARGET],
    DRBD_MAX_RATE: _DRBD_DEFAULTS[LDP_MAX_RATE],
    DRBD_MIN_RATE: _DRBD_DEFAULTS[LDP_MIN_RATE],
    },
  DT_DISKLESS: {},
  DT_FILE: {},
  DT_SHARED_FILE: {},
  DT_BLOCK: {},
  DT_RBD: {
    RBD_POOL: DISK_LD_DEFAULTS[DT_RBD][LDP_POOL],
    RBD_ACCESS: DISK_LD_DEFAULTS[DT_RBD][LDP_ACCESS],
    },
  DT_EXT: {},
  }

# we don't want to export the shortcuts
del _LV_DEFAULTS, _DRBD_DEFAULTS

NICC_DEFAULTS = {
  NIC_MODE: NIC_MODE_BRIDGED,
  NIC_LINK: DEFAULT_BRIDGE,
  NIC_VLAN: VALUE_HS_NOTHING,
  }

ISPECS_MINMAX_DEFAULTS = _constants.ISPECS_MINMAX_DEFAULTS

IPOLICY_DEFAULTS = {
  ISPECS_MINMAX: [ISPECS_MINMAX_DEFAULTS],
  ISPECS_STD: {
    ISPEC_MEM_SIZE: 128,
    ISPEC_CPU_COUNT: 1,
    ISPEC_DISK_COUNT: 1,
    ISPEC_DISK_SIZE: 1024,
    ISPEC_NIC_COUNT: 1,
    ISPEC_SPINDLE_USE: 1,
    },
  IPOLICY_DTS: list(DISK_TEMPLATES),
  IPOLICY_VCPU_RATIO: 4.0,
  IPOLICY_SPINDLE_RATIO: 32.0,
  }

MASTER_POOL_SIZE_DEFAULT = _constants.MASTER_POOL_SIZE_DEFAULT

PART_MARGIN = _constants.PART_MARGIN
PART_RESERVED = _constants.PART_RESERVED

CONFD_PROTOCOL_VERSION = _constants.CONFD_PROTOCOL_VERSION

CONFD_REQ_PING = _constants.CONFD_REQ_PING
CONFD_REQ_NODE_ROLE_BYNAME = _constants.CONFD_REQ_NODE_ROLE_BYNAME
CONFD_REQ_NODE_PIP_BY_INSTANCE_IP = _constants.CONFD_REQ_NODE_PIP_BY_INSTANCE_IP
CONFD_REQ_CLUSTER_MASTER = _constants.CONFD_REQ_CLUSTER_MASTER
CONFD_REQ_NODE_PIP_LIST = _constants.CONFD_REQ_NODE_PIP_LIST
CONFD_REQ_MC_PIP_LIST = _constants.CONFD_REQ_MC_PIP_LIST
CONFD_REQ_INSTANCES_IPS_LIST = _constants.CONFD_REQ_INSTANCES_IPS_LIST
CONFD_REQ_NODE_DRBD = _constants.CONFD_REQ_NODE_DRBD
CONFD_REQ_NODE_INSTANCES = _constants.CONFD_REQ_NODE_INSTANCES
CONFD_REQS = _constants.CONFD_REQS

CONFD_REQQ_LINK = _constants.CONFD_REQQ_LINK
CONFD_REQQ_IP = _constants.CONFD_REQQ_IP
CONFD_REQQ_IPLIST = _constants.CONFD_REQQ_IPLIST
CONFD_REQQ_FIELDS = _constants.CONFD_REQQ_FIELDS

# FIXME: perhaps update code that uses these constants to deal with
# integers instead of strings
CONFD_REQFIELD_NAME = str(_constants.CONFD_REQFIELD_NAME)
CONFD_REQFIELD_IP = str(_constants.CONFD_REQFIELD_IP)
CONFD_REQFIELD_MNODE_PIP = str(_constants.CONFD_REQFIELD_MNODE_PIP)

CONFD_REPL_STATUS_OK = _constants.CONFD_REPL_STATUS_OK
CONFD_REPL_STATUS_ERROR = _constants.CONFD_REPL_STATUS_ERROR
CONFD_REPL_STATUS_NOTIMPLEMENTED = _constants.CONFD_REPL_STATUS_NOTIMPLEMENTED
CONFD_REPL_STATUSES = _constants.CONFD_REPL_STATUSES

CONFD_NODE_ROLE_MASTER = _constants.CONFD_NODE_ROLE_MASTER
CONFD_NODE_ROLE_CANDIDATE = _constants.CONFD_NODE_ROLE_CANDIDATE
CONFD_NODE_ROLE_OFFLINE = _constants.CONFD_NODE_ROLE_OFFLINE
CONFD_NODE_ROLE_DRAINED = _constants.CONFD_NODE_ROLE_DRAINED
CONFD_NODE_ROLE_REGULAR = _constants.CONFD_NODE_ROLE_REGULAR

CONFD_ERROR_UNKNOWN_ENTRY = _constants.CONFD_ERROR_UNKNOWN_ENTRY
CONFD_ERROR_INTERNAL = _constants.CONFD_ERROR_INTERNAL
CONFD_ERROR_ARGUMENT = _constants.CONFD_ERROR_ARGUMENT

CONFD_MAX_CLOCK_SKEW = _constants.CONFD_MAX_CLOCK_SKEW

CONFD_CONFIG_RELOAD_TIMEOUT = _constants.CONFD_CONFIG_RELOAD_TIMEOUT
CONFD_CONFIG_RELOAD_RATELIMIT = _constants.CONFD_CONFIG_RELOAD_RATELIMIT

CONFD_MAGIC_FOURCC = _constants.CONFD_MAGIC_FOURCC

CONFD_DEFAULT_REQ_COVERAGE = _constants.CONFD_DEFAULT_REQ_COVERAGE

CONFD_CLIENT_EXPIRE_TIMEOUT = _constants.CONFD_CLIENT_EXPIRE_TIMEOUT

MAX_UDP_DATA_SIZE = _constants.MAX_UDP_DATA_SIZE

# User-id pool minimum/maximum acceptable user-ids.
UIDPOOL_UID_MIN = 0
UIDPOOL_UID_MAX = 2 ** 32 - 1 # Assuming 32 bit user-ids

# Name or path of the pgrep command
PGREP = "pgrep"

# Name of the node group that gets created at cluster init or upgrade
INITIAL_NODE_GROUP_NAME = "default"

ALLOC_POLICY_PREFERRED = _constants.ALLOC_POLICY_PREFERRED
ALLOC_POLICY_LAST_RESORT = _constants.ALLOC_POLICY_LAST_RESORT
ALLOC_POLICY_UNALLOCABLE = _constants.ALLOC_POLICY_UNALLOCABLE
VALID_ALLOC_POLICIES = _constants.VALID_ALLOC_POLICIES

BLOCKDEV_DRIVER_MANUAL = _constants.BLOCKDEV_DRIVER_MANUAL

QEMUIMG_PATH = _constants.QEMUIMG_PATH

HTOOLS = _constants.HTOOLS
# The hail iallocator
IALLOC_HAIL = "hail"

# Fake opcodes for functions that have hooks attached to them via
# backend.RunLocalHooks
FAKE_OP_MASTER_TURNUP = "OP_CLUSTER_IP_TURNUP"
FAKE_OP_MASTER_TURNDOWN = "OP_CLUSTER_IP_TURNDOWN"

# SSH key types
SSHK_RSA = "rsa"
SSHK_DSA = "dsa"
SSHK_ALL = compat.UniqueFrozenset([SSHK_RSA, SSHK_DSA])

# SSH authorized key types
SSHAK_RSA = "ssh-rsa"
SSHAK_DSS = "ssh-dss"
SSHAK_ALL = compat.UniqueFrozenset([SSHAK_RSA, SSHAK_DSS])

# SSH setup
SSHS_CLUSTER_NAME = "cluster_name"
SSHS_SSH_HOST_KEY = "ssh_host_key"
SSHS_SSH_ROOT_KEY = "ssh_root_key"
SSHS_NODE_DAEMON_CERTIFICATE = "node_daemon_certificate"

#: Key files for SSH daemon
SSH_DAEMON_KEYFILES = {
  SSHK_RSA: (pathutils.SSH_HOST_RSA_PRIV, pathutils.SSH_HOST_RSA_PUB),
  SSHK_DSA: (pathutils.SSH_HOST_DSA_PRIV, pathutils.SSH_HOST_DSA_PUB),
  }

# Node daemon setup
NDS_CLUSTER_NAME = "cluster_name"
NDS_NODE_DAEMON_CERTIFICATE = "node_daemon_certificate"
NDS_SSCONF = "ssconf"
NDS_START_NODE_DAEMON = "start_node_daemon"

RANDOM_UUID_FILE = _constants.RANDOM_UUID_FILE

# Regex string for verifying a UUID
UUID_REGEX = "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$"

AUTO_REPAIR_TAG_PREFIX = _constants.AUTO_REPAIR_TAG_PREFIX
AUTO_REPAIR_TAG_ENABLED = _constants.AUTO_REPAIR_TAG_ENABLED
AUTO_REPAIR_TAG_SUSPENDED = _constants.AUTO_REPAIR_TAG_SUSPENDED
AUTO_REPAIR_TAG_PENDING = _constants.AUTO_REPAIR_TAG_PENDING
AUTO_REPAIR_TAG_RESULT = _constants.AUTO_REPAIR_TAG_RESULT

AUTO_REPAIR_FIX_STORAGE = _constants.AUTO_REPAIR_FIX_STORAGE
AUTO_REPAIR_MIGRATE = _constants.AUTO_REPAIR_MIGRATE
AUTO_REPAIR_FAILOVER = _constants.AUTO_REPAIR_FAILOVER
AUTO_REPAIR_REINSTALL = _constants.AUTO_REPAIR_REINSTALL
AUTO_REPAIR_ALL_TYPES = _constants.AUTO_REPAIR_ALL_TYPES

AUTO_REPAIR_SUCCESS = _constants.AUTO_REPAIR_SUCCESS
AUTO_REPAIR_FAILURE = _constants.AUTO_REPAIR_FAILURE
AUTO_REPAIR_ENOPERM = _constants.AUTO_REPAIR_ENOPERM
AUTO_REPAIR_ALL_RESULTS = _constants.AUTO_REPAIR_ALL_RESULTS

BUILTIN_DATA_COLLECTOR_VERSION = _constants.BUILTIN_DATA_COLLECTOR_VERSION

OPCODE_REASON = _constants.OPCODE_REASON

# The source reasons for the execution of an OpCode
OPCODE_REASON_SRC_CLIENT = "gnt:client"
OPCODE_REASON_SRC_NODED = "gnt:daemon:noded"
OPCODE_REASON_SRC_OPCODE = "gnt:opcode"
OPCODE_REASON_SRC_RLIB2 = "gnt:library:rlib2"
OPCODE_REASON_SRC_USER = "gnt:user"

OPCODE_REASON_SOURCES = compat.UniqueFrozenset([
  OPCODE_REASON_SRC_CLIENT,
  OPCODE_REASON_SRC_NODED,
  OPCODE_REASON_SRC_OPCODE,
  OPCODE_REASON_SRC_RLIB2,
  OPCODE_REASON_SRC_USER,
  ])

DISKSTATS_FILE = _constants.DISKSTATS_FILE

STAT_FILE = _constants.STAT_FILE
CPUAVGLOAD_BUFFER_SIZE = _constants.CPUAVGLOAD_BUFFER_SIZE
CPUAVGLOAD_WINDOW_SIZE = _constants.CPUAVGLOAD_WINDOW_SIZE

MOND_TIME_INTERVAL = _constants.MOND_TIME_INTERVAL

# MonD's latest API version
MOND_LATEST_API_VERSION = 1

# Timeouts for upgrades

UPGRADE_QUEUE_DRAIN_TIMEOUT = _constants.UPGRADE_QUEUE_DRAIN_TIMEOUT
UPGRADE_QUEUE_POLL_INTERVAL = _constants.UPGRADE_QUEUE_POLL_INTERVAL

# Do not re-export imported modules
del re, _vcsversion, _constants, socket, pathutils, compat


ALLOCATABLE_KEY = "allocatable"
FAILED_KEY = "failed"
